# Normalize date and ticker
events["date"] = pd.to_datetime(events["date"], dayfirst=True, errors="coerce")
events["ticker"] = events["ticker"].astype(str).str.upper()

# Fix Ubisoft ticker: map empty/UBI.PA to UBSFY
events.loc[events["publisher"] == "Ubisoft", "ticker"] = "UBSFY"
events["ticker"] = events["ticker"].str.replace("UBI.PA", "UBSFY", regex=False)

print(events[["event_id", "date", "ticker", "publisher"]].head(15))
print("Unique tickers in events:", events["ticker"].unique())